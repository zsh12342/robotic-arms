# 功能描述

在机器人校正流程中增加一个零点微调功能，用来解决脚踝不易调准、每次未调准需要断电重新调整电机初始位置再启动校正程序的繁琐流程。

# 支持的版本

适用于 0.0.3-859-gaf0096d2 及之后的版本。

# 使用方法

1. **启动零点校正程序：**
   使用命令 `sudo ./src/biped_v2/kuavoController --real --cali` 启动程序。在提示时按下 `c` 键进入临时的零点调试功能。

2. **创建临时文件：**
   按下 `c` 键后，程序会新建一个 `/tmp/lejuconfig/offset.csv` 文件，此文件是从 `~/.config/lejuconfig/offset.csv` 复制过来的。

3. **编辑临时文件：**
   用常用的编辑器打开 `/tmp/lejuconfig/offset.csv`，修改对应关节的角度值。如果需要调整脚踝，修改 5, 6, 11, 12 这四个关节的值。通常零点是正确的，只需在原有值上加减 10 的整数倍即可。注意，一开始先加减 10 度，保存后进入第 4 步测试方向，再继续修改。

   如果编辑器提示无法保存，是因为该零点文件是通过 `sudo` 命令创建的，需要管理员权限。可以通过以下两种方法解决：
   - 修改文件的所有者为 `lab`，例如使用命令 `sudo chown lab /tmp/lejuconfig/offset.csv`。
   - 使用 `sudo` 启动编辑器，例如 `sudo nano /tmp/lejuconfig/offset.csv`。

4. **测试调整：**
   修改并保存 `/tmp/lejuconfig/offset.csv` 后，回到终端按下 `r` 键，程序会加载新的零点。观察关节的运动方向和位置是否合理。如需进一步调整，请重复第 3 步。

5. **保存调整：**
   调整到满意状态后，按下 `q` 退出调零功能，然后按下 `Ctrl+C` 退出校正程序。

6. **进入步态准备阶段：**
   使用命令 `sudo ./src/biped_v2/kuavoController --real --log_lcm` 让机器人进入步态准备阶段。

# 补充事项

1. 每次断电重启后，圈数可能会不同，因此 `/tmp/lejuconfig/offset.csv` 文件会自动清除。如果按下应急开关断电再重新上电，也需要在执行校正程序前手动删除 `/tmp/lejuconfig/offset.csv` 文件。如果没有权限，请使用 `sudo` 命令执行。

2. 如果电机驱动板没有断电，则不需要每次启动前都重新校正零点。
